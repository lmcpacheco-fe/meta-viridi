#MACHINE ??= 'imx91evk'
#MACHINE ??= 'viridi-imx91'
#MACHINE ??= 'viridi-imx93'
DISTRO ?= 'fsl-imx-wayland'
EXTRA_IMAGE_FEATURES ?= "allow-empty-password empty-root-password allow-root-login"
USER_CLASSES ?= "buildstats"
PATCHRESOLVE = "noop"
BB_DISKMON_DIRS ??= "\
    STOPTASKS,${TMPDIR},1G,100K \
    STOPTASKS,${DL_DIR},1G,100K \
    STOPTASKS,${SSTATE_DIR},1G,100K \
    STOPTASKS,/tmp,100M,100K \
    HALT,${TMPDIR},100M,1K \
    HALT,${DL_DIR},100M,1K \
    HALT,${SSTATE_DIR},100M,1K \
    HALT,/tmp,10M,1K"
PACKAGECONFIG:append:pn-qemu-system-native = " sdl"
CONF_VERSION = "2"

DL_DIR ?= "${BSPDIR}/downloads/"
ACCEPT_FSL_EULA = "1"

# Switch to Debian packaging and include package-management in the image
PACKAGE_CLASSES = "package_deb"
EXTRA_IMAGE_FEATURES += "package-management"
# Install common commands for testing peripherals
MACHINE_FEATURES:append = " wifi bluetooth"
DISTRO_FEATURES:append = " wifi ipv4 ipv6 bluetooth"

CORE_IMAGE_EXTRA_INSTALL += " \
    libgpiod libgpiod-tools i2c-tools \
    net-tools wpa-supplicant ethtool \
    tmux dtc openssh openssh-sftp-server \
    wireless-regdb-static \
    picocom vim iw \
    bluez5 bluez5-obex \
    kernel-module-mwifiex-sdio \
    maya-fw \
"
# Add our test script to the build
CORE_IMAGE_EXTRA_INSTALL += "sdc-tests"
